import axios from 'axios';
import db from '../index';
import { IQuery, IStock } from '../../utils/types';

//Sample api data returns for testing without burning API calls
const queries = [
	{
		query: `insert into stock_histories (TIME_SERIES_INTRADAY, stock_id)
  values ($1, (select id from stocks where symbol = 'ACB'))
  on conflict (stock_id) do
  update set TIME_SERIES_INTRADAY = $1`,
		params: [
			{
				'Meta Data': {
					'1. Information':
						'Intraday (5min) open, high, low, close prices and volume',
					'2. Symbol': 'ACB',
					'3. Last Refreshed': '2020-03-13 16:00:00',
					'4. Interval': '5min',
					'5. Output Size': 'Compact',
					'6. Time Zone': 'US/Eastern'
				},
				'Time Series (5min)': {
					'2020-03-13 16:00:00': {
						'1. open': '0.7600',
						'2. high': '0.7700',
						'3. low': '0.7600',
						'4. close': '0.7700',
						'5. volume': '316180'
					},
					'2020-03-13 15:55:00': {
						'1. open': '0.7600',
						'2. high': '0.7601',
						'3. low': '0.7589',
						'4. close': '0.7590',
						'5. volume': '152049'
					},
					'2020-03-13 15:50:00': {
						'1. open': '0.7577',
						'2. high': '0.7625',
						'3. low': '0.7577',
						'4. close': '0.7601',
						'5. volume': '250885'
					},
					'2020-03-13 15:45:00': {
						'1. open': '0.7435',
						'2. high': '0.7575',
						'3. low': '0.7435',
						'4. close': '0.7575',
						'5. volume': '242507'
					},
					'2020-03-13 15:40:00': {
						'1. open': '0.7432',
						'2. high': '0.7454',
						'3. low': '0.7420',
						'4. close': '0.7436',
						'5. volume': '100456'
					},
					'2020-03-13 15:35:00': {
						'1. open': '0.7430',
						'2. high': '0.7479',
						'3. low': '0.7423',
						'4. close': '0.7426',
						'5. volume': '119773'
					},
					'2020-03-13 15:30:00': {
						'1. open': '0.7446',
						'2. high': '0.7489',
						'3. low': '0.7405',
						'4. close': '0.7429',
						'5. volume': '254825'
					},
					'2020-03-13 15:25:00': {
						'1. open': '0.7560',
						'2. high': '0.7560',
						'3. low': '0.7400',
						'4. close': '0.7445',
						'5. volume': '223096'
					},
					'2020-03-13 15:20:00': {
						'1. open': '0.7502',
						'2. high': '0.7583',
						'3. low': '0.7502',
						'4. close': '0.7560',
						'5. volume': '121014'
					},
					'2020-03-13 15:15:00': {
						'1. open': '0.7495',
						'2. high': '0.7549',
						'3. low': '0.7491',
						'4. close': '0.7531',
						'5. volume': '173830'
					},
					'2020-03-13 15:10:00': {
						'1. open': '0.7494',
						'2. high': '0.7495',
						'3. low': '0.7489',
						'4. close': '0.7495',
						'5. volume': '127738'
					},
					'2020-03-13 15:05:00': {
						'1. open': '0.7482',
						'2. high': '0.7500',
						'3. low': '0.7474',
						'4. close': '0.7495',
						'5. volume': '55028'
					},
					'2020-03-13 15:00:00': {
						'1. open': '0.7500',
						'2. high': '0.7500',
						'3. low': '0.7500',
						'4. close': '0.7500',
						'5. volume': '82155'
					},
					'2020-03-13 14:55:00': {
						'1. open': '0.7490',
						'2. high': '0.7495',
						'3. low': '0.7444',
						'4. close': '0.7462',
						'5. volume': '110485'
					},
					'2020-03-13 14:50:00': {
						'1. open': '0.7456',
						'2. high': '0.7500',
						'3. low': '0.7456',
						'4. close': '0.7488',
						'5. volume': '101382'
					},
					'2020-03-13 14:45:00': {
						'1. open': '0.7451',
						'2. high': '0.7471',
						'3. low': '0.7400',
						'4. close': '0.7447',
						'5. volume': '99019'
					},
					'2020-03-13 14:40:00': {
						'1. open': '0.7500',
						'2. high': '0.7600',
						'3. low': '0.7500',
						'4. close': '0.7500',
						'5. volume': '67456'
					},
					'2020-03-13 14:35:00': {
						'1. open': '0.7496',
						'2. high': '0.7499',
						'3. low': '0.7454',
						'4. close': '0.7454',
						'5. volume': '68707'
					},
					'2020-03-13 14:30:00': {
						'1. open': '0.7499',
						'2. high': '0.7500',
						'3. low': '0.7451',
						'4. close': '0.7500',
						'5. volume': '76386'
					},
					'2020-03-13 14:25:00': {
						'1. open': '0.7548',
						'2. high': '0.7551',
						'3. low': '0.7497',
						'4. close': '0.7499',
						'5. volume': '99411'
					},
					'2020-03-13 14:20:00': {
						'1. open': '0.7500',
						'2. high': '0.7557',
						'3. low': '0.7500',
						'4. close': '0.7547',
						'5. volume': '55057'
					},
					'2020-03-13 14:15:00': {
						'1. open': '0.7496',
						'2. high': '0.7500',
						'3. low': '0.7461',
						'4. close': '0.7500',
						'5. volume': '71662'
					},
					'2020-03-13 14:10:00': {
						'1. open': '0.7545',
						'2. high': '0.7569',
						'3. low': '0.7500',
						'4. close': '0.7500',
						'5. volume': '171464'
					},
					'2020-03-13 14:05:00': {
						'1. open': '0.7570',
						'2. high': '0.7570',
						'3. low': '0.7544',
						'4. close': '0.7552',
						'5. volume': '149991'
					},
					'2020-03-13 14:00:00': {
						'1. open': '0.7600',
						'2. high': '0.7600',
						'3. low': '0.7500',
						'4. close': '0.7600',
						'5. volume': '127060'
					},
					'2020-03-13 13:55:00': {
						'1. open': '0.7571',
						'2. high': '0.7666',
						'3. low': '0.7565',
						'4. close': '0.7601',
						'5. volume': '146789'
					},
					'2020-03-13 13:50:00': {
						'1. open': '0.7600',
						'2. high': '0.7700',
						'3. low': '0.7600',
						'4. close': '0.7600',
						'5. volume': '84969'
					},
					'2020-03-13 13:45:00': {
						'1. open': '0.7572',
						'2. high': '0.7589',
						'3. low': '0.7529',
						'4. close': '0.7568',
						'5. volume': '86168'
					},
					'2020-03-13 13:40:00': {
						'1. open': '0.7589',
						'2. high': '0.7589',
						'3. low': '0.7501',
						'4. close': '0.7572',
						'5. volume': '193743'
					},
					'2020-03-13 13:35:00': {
						'1. open': '0.7479',
						'2. high': '0.7599',
						'3. low': '0.7475',
						'4. close': '0.7587',
						'5. volume': '155844'
					},
					'2020-03-13 13:30:00': {
						'1. open': '0.7473',
						'2. high': '0.7496',
						'3. low': '0.7473',
						'4. close': '0.7479',
						'5. volume': '175442'
					},
					'2020-03-13 13:25:00': {
						'1. open': '0.7420',
						'2. high': '0.7480',
						'3. low': '0.7400',
						'4. close': '0.7473',
						'5. volume': '466683'
					},
					'2020-03-13 13:20:00': {
						'1. open': '0.7374',
						'2. high': '0.7420',
						'3. low': '0.7366',
						'4. close': '0.7401',
						'5. volume': '220474'
					},
					'2020-03-13 13:15:00': {
						'1. open': '0.7316',
						'2. high': '0.7387',
						'3. low': '0.7316',
						'4. close': '0.7385',
						'5. volume': '103872'
					},
					'2020-03-13 13:10:00': {
						'1. open': '0.7311',
						'2. high': '0.7316',
						'3. low': '0.7300',
						'4. close': '0.7316',
						'5. volume': '153630'
					},
					'2020-03-13 13:05:00': {
						'1. open': '0.7364',
						'2. high': '0.7364',
						'3. low': '0.7342',
						'4. close': '0.7345',
						'5. volume': '120740'
					},
					'2020-03-13 13:00:00': {
						'1. open': '0.7400',
						'2. high': '0.7400',
						'3. low': '0.7300',
						'4. close': '0.7300',
						'5. volume': '167084'
					},
					'2020-03-13 12:55:00': {
						'1. open': '0.7393',
						'2. high': '0.7465',
						'3. low': '0.7369',
						'4. close': '0.7370',
						'5. volume': '127289'
					},
					'2020-03-13 12:50:00': {
						'1. open': '0.7365',
						'2. high': '0.7400',
						'3. low': '0.7336',
						'4. close': '0.7384',
						'5. volume': '123214'
					},
					'2020-03-13 12:45:00': {
						'1. open': '0.7323',
						'2. high': '0.7399',
						'3. low': '0.7323',
						'4. close': '0.7364',
						'5. volume': '98123'
					},
					'2020-03-13 12:40:00': {
						'1. open': '0.7398',
						'2. high': '0.7400',
						'3. low': '0.7300',
						'4. close': '0.7323',
						'5. volume': '305373'
					},
					'2020-03-13 12:35:00': {
						'1. open': '0.7228',
						'2. high': '0.7400',
						'3. low': '0.7227',
						'4. close': '0.7400',
						'5. volume': '401255'
					},
					'2020-03-13 12:30:00': {
						'1. open': '0.7230',
						'2. high': '0.7269',
						'3. low': '0.7200',
						'4. close': '0.7228',
						'5. volume': '209087'
					},
					'2020-03-13 12:25:00': {
						'1. open': '0.7192',
						'2. high': '0.7231',
						'3. low': '0.7186',
						'4. close': '0.7230',
						'5. volume': '87290'
					},
					'2020-03-13 12:20:00': {
						'1. open': '0.7094',
						'2. high': '0.7200',
						'3. low': '0.7089',
						'4. close': '0.7192',
						'5. volume': '205791'
					},
					'2020-03-13 12:15:00': {
						'1. open': '0.7100',
						'2. high': '0.7200',
						'3. low': '0.7100',
						'4. close': '0.7100',
						'5. volume': '322047'
					},
					'2020-03-13 12:10:00': {
						'1. open': '0.7082',
						'2. high': '0.7094',
						'3. low': '0.7080',
						'4. close': '0.7080',
						'5. volume': '129683'
					},
					'2020-03-13 12:05:00': {
						'1. open': '0.7185',
						'2. high': '0.7200',
						'3. low': '0.7080',
						'4. close': '0.7082',
						'5. volume': '438282'
					},
					'2020-03-13 12:00:00': {
						'1. open': '0.7200',
						'2. high': '0.7252',
						'3. low': '0.7173',
						'4. close': '0.7200',
						'5. volume': '315802'
					},
					'2020-03-13 11:55:00': {
						'1. open': '0.7302',
						'2. high': '0.7302',
						'3. low': '0.7157',
						'4. close': '0.7176',
						'5. volume': '281500'
					},
					'2020-03-13 11:50:00': {
						'1. open': '0.7200',
						'2. high': '0.7355',
						'3. low': '0.7200',
						'4. close': '0.7301',
						'5. volume': '193104'
					},
					'2020-03-13 11:45:00': {
						'1. open': '0.7345',
						'2. high': '0.7346',
						'3. low': '0.7200',
						'4. close': '0.7201',
						'5. volume': '459776'
					},
					'2020-03-13 11:40:00': {
						'1. open': '0.7501',
						'2. high': '0.7519',
						'3. low': '0.7340',
						'4. close': '0.7345',
						'5. volume': '321015'
					},
					'2020-03-13 11:35:00': {
						'1. open': '0.7612',
						'2. high': '0.7612',
						'3. low': '0.7500',
						'4. close': '0.7500',
						'5. volume': '262753'
					},
					'2020-03-13 11:30:00': {
						'1. open': '0.7602',
						'2. high': '0.7638',
						'3. low': '0.7601',
						'4. close': '0.7617',
						'5. volume': '86342'
					},
					'2020-03-13 11:25:00': {
						'1. open': '0.7666',
						'2. high': '0.7699',
						'3. low': '0.7600',
						'4. close': '0.7618',
						'5. volume': '240944'
					},
					'2020-03-13 11:20:00': {
						'1. open': '0.7739',
						'2. high': '0.7760',
						'3. low': '0.7665',
						'4. close': '0.7700',
						'5. volume': '269335'
					},
					'2020-03-13 11:15:00': {
						'1. open': '0.7778',
						'2. high': '0.7778',
						'3. low': '0.7737',
						'4. close': '0.7750',
						'5. volume': '135639'
					},
					'2020-03-13 11:10:00': {
						'1. open': '0.7739',
						'2. high': '0.7799',
						'3. low': '0.7732',
						'4. close': '0.7770',
						'5. volume': '150997'
					},
					'2020-03-13 11:05:00': {
						'1. open': '0.7722',
						'2. high': '0.7740',
						'3. low': '0.7711',
						'4. close': '0.7738',
						'5. volume': '168742'
					},
					'2020-03-13 11:00:00': {
						'1. open': '0.7800',
						'2. high': '0.7900',
						'3. low': '0.7700',
						'4. close': '0.7700',
						'5. volume': '355804'
					},
					'2020-03-13 10:55:00': {
						'1. open': '0.7860',
						'2. high': '0.7860',
						'3. low': '0.7762',
						'4. close': '0.7802',
						'5. volume': '198062'
					},
					'2020-03-13 10:50:00': {
						'1. open': '0.7759',
						'2. high': '0.7898',
						'3. low': '0.7759',
						'4. close': '0.7860',
						'5. volume': '218954'
					},
					'2020-03-13 10:45:00': {
						'1. open': '0.7902',
						'2. high': '0.7906',
						'3. low': '0.7785',
						'4. close': '0.7785',
						'5. volume': '417172'
					},
					'2020-03-13 10:40:00': {
						'1. open': '0.7943',
						'2. high': '0.7950',
						'3. low': '0.7900',
						'4. close': '0.7909',
						'5. volume': '392604'
					},
					'2020-03-13 10:35:00': {
						'1. open': '0.7900',
						'2. high': '0.7936',
						'3. low': '0.7899',
						'4. close': '0.7900',
						'5. volume': '284312'
					},
					'2020-03-13 10:30:00': {
						'1. open': '0.7899',
						'2. high': '0.7990',
						'3. low': '0.7800',
						'4. close': '0.7851',
						'5. volume': '788415'
					},
					'2020-03-13 10:25:00': {
						'1. open': '0.7800',
						'2. high': '0.7900',
						'3. low': '0.7798',
						'4. close': '0.7899',
						'5. volume': '528048'
					},
					'2020-03-13 10:20:00': {
						'1. open': '0.7665',
						'2. high': '0.7800',
						'3. low': '0.7664',
						'4. close': '0.7800',
						'5. volume': '396604'
					},
					'2020-03-13 10:15:00': {
						'1. open': '0.7597',
						'2. high': '0.7666',
						'3. low': '0.7597',
						'4. close': '0.7665',
						'5. volume': '325956'
					},
					'2020-03-13 10:10:00': {
						'1. open': '0.7703',
						'2. high': '0.7772',
						'3. low': '0.7573',
						'4. close': '0.7599',
						'5. volume': '463146'
					},
					'2020-03-13 10:05:00': {
						'1. open': '0.7320',
						'2. high': '0.7700',
						'3. low': '0.7301',
						'4. close': '0.7684',
						'5. volume': '674084'
					},
					'2020-03-13 10:00:00': {
						'1. open': '0.7300',
						'2. high': '0.7400',
						'3. low': '0.7300',
						'4. close': '0.7300',
						'5. volume': '280064'
					},
					'2020-03-13 09:55:00': {
						'1. open': '0.7300',
						'2. high': '0.7350',
						'3. low': '0.7300',
						'4. close': '0.7300',
						'5. volume': '555759'
					},
					'2020-03-13 09:50:00': {
						'1. open': '0.7169',
						'2. high': '0.7300',
						'3. low': '0.7145',
						'4. close': '0.7272',
						'5. volume': '746385'
					},
					'2020-03-13 09:45:00': {
						'1. open': '0.7350',
						'2. high': '0.7350',
						'3. low': '0.7145',
						'4. close': '0.7169',
						'5. volume': '880279'
					},
					'2020-03-13 09:40:00': {
						'1. open': '0.7500',
						'2. high': '0.7501',
						'3. low': '0.7349',
						'4. close': '0.7349',
						'5. volume': '591140'
					},
					'2020-03-13 09:35:00': {
						'1. open': '0.7661',
						'2. high': '0.7690',
						'3. low': '0.7500',
						'4. close': '0.7500',
						'5. volume': '1699121'
					},
					'2020-03-12 16:00:00': {
						'1. open': '0.7100',
						'2. high': '0.7100',
						'3. low': '0.7000',
						'4. close': '0.7000',
						'5. volume': '901022'
					},
					'2020-03-12 15:55:00': {
						'1. open': '0.6961',
						'2. high': '0.7086',
						'3. low': '0.6960',
						'4. close': '0.7067',
						'5. volume': '227749'
					},
					'2020-03-12 15:50:00': {
						'1. open': '0.7003',
						'2. high': '0.7004',
						'3. low': '0.6902',
						'4. close': '0.6961',
						'5. volume': '465220'
					},
					'2020-03-12 15:45:00': {
						'1. open': '0.6939',
						'2. high': '0.7006',
						'3. low': '0.6898',
						'4. close': '0.7006',
						'5. volume': '264995'
					},
					'2020-03-12 15:40:00': {
						'1. open': '0.6836',
						'2. high': '0.6958',
						'3. low': '0.6835',
						'4. close': '0.6939',
						'5. volume': '538426'
					},
					'2020-03-12 15:35:00': {
						'1. open': '0.6836',
						'2. high': '0.6836',
						'3. low': '0.6835',
						'4. close': '0.6836',
						'5. volume': '224653'
					},
					'2020-03-12 15:30:00': {
						'1. open': '0.6821',
						'2. high': '0.6868',
						'3. low': '0.6820',
						'4. close': '0.6836',
						'5. volume': '461119'
					},
					'2020-03-12 15:25:00': {
						'1. open': '0.6812',
						'2. high': '0.6833',
						'3. low': '0.6812',
						'4. close': '0.6820',
						'5. volume': '228007'
					},
					'2020-03-12 15:20:00': {
						'1. open': '0.6804',
						'2. high': '0.6838',
						'3. low': '0.6804',
						'4. close': '0.6817',
						'5. volume': '487860'
					},
					'2020-03-12 15:15:00': {
						'1. open': '0.6829',
						'2. high': '0.6839',
						'3. low': '0.6802',
						'4. close': '0.6803',
						'5. volume': '263817'
					},
					'2020-03-12 15:10:00': {
						'1. open': '0.6871',
						'2. high': '0.6871',
						'3. low': '0.6803',
						'4. close': '0.6826',
						'5. volume': '240447'
					},
					'2020-03-12 15:05:00': {
						'1. open': '0.6862',
						'2. high': '0.6871',
						'3. low': '0.6862',
						'4. close': '0.6870',
						'5. volume': '211374'
					},
					'2020-03-12 15:00:00': {
						'1. open': '0.6900',
						'2. high': '0.6900',
						'3. low': '0.6900',
						'4. close': '0.6900',
						'5. volume': '248659'
					},
					'2020-03-12 14:55:00': {
						'1. open': '0.6876',
						'2. high': '0.6877',
						'3. low': '0.6876',
						'4. close': '0.6876',
						'5. volume': '176281'
					},
					'2020-03-12 14:50:00': {
						'1. open': '0.6900',
						'2. high': '0.6900',
						'3. low': '0.6877',
						'4. close': '0.6900',
						'5. volume': '351815'
					},
					'2020-03-12 14:45:00': {
						'1. open': '0.6813',
						'2. high': '0.6874',
						'3. low': '0.6800',
						'4. close': '0.6833',
						'5. volume': '259037'
					},
					'2020-03-12 14:40:00': {
						'1. open': '0.6927',
						'2. high': '0.6927',
						'3. low': '0.6801',
						'4. close': '0.6824',
						'5. volume': '227251'
					},
					'2020-03-12 14:35:00': {
						'1. open': '0.6915',
						'2. high': '0.6950',
						'3. low': '0.6910',
						'4. close': '0.6915',
						'5. volume': '287194'
					},
					'2020-03-12 14:30:00': {
						'1. open': '0.6968',
						'2. high': '0.7032',
						'3. low': '0.6891',
						'4. close': '0.6918',
						'5. volume': '556091'
					},
					'2020-03-12 14:25:00': {
						'1. open': '0.7000',
						'2. high': '0.7000',
						'3. low': '0.6954',
						'4. close': '0.6965',
						'5. volume': '177585'
					},
					'2020-03-12 14:20:00': {
						'1. open': '0.7047',
						'2. high': '0.7047',
						'3. low': '0.6974',
						'4. close': '0.7000',
						'5. volume': '322303'
					},
					'2020-03-12 14:15:00': {
						'1. open': '0.7087',
						'2. high': '0.7087',
						'3. low': '0.7000',
						'4. close': '0.7005',
						'5. volume': '645540'
					}
				}
			}
		]
	},
	{
		query: `insert into stock_histories (TIME_SERIES_DAILY, stock_id)
    values ($1, (select id from stocks where symbol = 'ACB'))
    on conflict (stock_id) do
    update set TIME_SERIES_DAILY = $1`,
		params: [
			{
				'Meta Data': {
					'1. Information': 'Daily Prices (open, high, low, close) and Volumes',
					'2. Symbol': 'ACB',
					'3. Last Refreshed': '2020-03-13',
					'4. Output Size': 'Compact',
					'5. Time Zone': 'US/Eastern'
				},
				'Time Series (Daily)': {
					'2020-03-13': {
						'1. open': '0.7721',
						'2. high': '0.7990',
						'3. low': '0.7028',
						'4. close': '0.7700',
						'5. volume': '24559678'
					},
					'2020-03-12': {
						'1. open': '0.6801',
						'2. high': '0.7400',
						'3. low': '0.6300',
						'4. close': '0.7001',
						'5. volume': '41546525'
					},
					'2020-03-11': {
						'1. open': '0.9620',
						'2. high': '0.9820',
						'3. low': '0.8500',
						'4. close': '0.8587',
						'5. volume': '21826334'
					},
					'2020-03-10': {
						'1. open': '1.0300',
						'2. high': '1.0700',
						'3. low': '0.9600',
						'4. close': '0.9802',
						'5. volume': '22182204'
					},
					'2020-03-09': {
						'1. open': '0.9601',
						'2. high': '1.0900',
						'3. low': '0.9000',
						'4. close': '0.9490',
						'5. volume': '27748756'
					},
					'2020-03-06': {
						'1. open': '1.2800',
						'2. high': '1.2900',
						'3. low': '1.1300',
						'4. close': '1.1700',
						'5. volume': '24907729'
					},
					'2020-03-05': {
						'1. open': '1.3500',
						'2. high': '1.3800',
						'3. low': '1.3100',
						'4. close': '1.3100',
						'5. volume': '13034234'
					},
					'2020-03-04': {
						'1. open': '1.3400',
						'2. high': '1.4300',
						'3. low': '1.3200',
						'4. close': '1.3800',
						'5. volume': '17805981'
					},
					'2020-03-03': {
						'1. open': '1.3800',
						'2. high': '1.4000',
						'3. low': '1.3100',
						'4. close': '1.3300',
						'5. volume': '16124773'
					},
					'2020-03-02': {
						'1. open': '1.3900',
						'2. high': '1.4000',
						'3. low': '1.3100',
						'4. close': '1.3600',
						'5. volume': '17860970'
					},
					'2020-02-28': {
						'1. open': '1.3600',
						'2. high': '1.4000',
						'3. low': '1.3200',
						'4. close': '1.3400',
						'5. volume': '26449219'
					},
					'2020-02-27': {
						'1. open': '1.4500',
						'2. high': '1.5300',
						'3. low': '1.3500',
						'4. close': '1.4500',
						'5. volume': '26205091'
					},
					'2020-02-26': {
						'1. open': '1.4900',
						'2. high': '1.5800',
						'3. low': '1.4900',
						'4. close': '1.5100',
						'5. volume': '20720920'
					},
					'2020-02-25': {
						'1. open': '1.5800',
						'2. high': '1.5900',
						'3. low': '1.4900',
						'4. close': '1.5100',
						'5. volume': '23314337'
					},
					'2020-02-24': {
						'1. open': '1.5800',
						'2. high': '1.6200',
						'3. low': '1.5400',
						'4. close': '1.5500',
						'5. volume': '24764528'
					},
					'2020-02-21': {
						'1. open': '1.6900',
						'2. high': '1.7000',
						'3. low': '1.6200',
						'4. close': '1.6700',
						'5. volume': '13617484'
					},
					'2020-02-20': {
						'1. open': '1.7400',
						'2. high': '1.7900',
						'3. low': '1.6500',
						'4. close': '1.6800',
						'5. volume': '35603407'
					},
					'2020-02-19': {
						'1. open': '1.6600',
						'2. high': '1.7400',
						'3. low': '1.6400',
						'4. close': '1.7100',
						'5. volume': '23477425'
					},
					'2020-02-18': {
						'1. open': '1.5600',
						'2. high': '1.6600',
						'3. low': '1.5500',
						'4. close': '1.6400',
						'5. volume': '39509715'
					},
					'2020-02-14': {
						'1. open': '1.5800',
						'2. high': '1.5900',
						'3. low': '1.4800',
						'4. close': '1.5800',
						'5. volume': '60823339'
					},
					'2020-02-13': {
						'1. open': '1.4300',
						'2. high': '1.5600',
						'3. low': '1.4300',
						'4. close': '1.4700',
						'5. volume': '47475126'
					},
					'2020-02-12': {
						'1. open': '1.5500',
						'2. high': '1.5800',
						'3. low': '1.4400',
						'4. close': '1.4600',
						'5. volume': '37279574'
					},
					'2020-02-11': {
						'1. open': '1.5600',
						'2. high': '1.6700',
						'3. low': '1.5200',
						'4. close': '1.5400',
						'5. volume': '36709918'
					},
					'2020-02-10': {
						'1. open': '1.6500',
						'2. high': '1.6800',
						'3. low': '1.5500',
						'4. close': '1.5600',
						'5. volume': '30498289'
					},
					'2020-02-07': {
						'1. open': '1.6600',
						'2. high': '1.8000',
						'3. low': '1.6500',
						'4. close': '1.7000',
						'5. volume': '47515578'
					},
					'2020-02-06': {
						'1. open': '2.1000',
						'2. high': '2.1400',
						'3. low': '2.0000',
						'4. close': '2.0012',
						'5. volume': '15629886'
					},
					'2020-02-05': {
						'1. open': '2.2000',
						'2. high': '2.2000',
						'3. low': '2.0400',
						'4. close': '2.1200',
						'5. volume': '25455279'
					},
					'2020-02-04': {
						'1. open': '2.0500',
						'2. high': '2.1600',
						'3. low': '2.0300',
						'4. close': '2.1400',
						'5. volume': '31085479'
					},
					'2020-02-03': {
						'1. open': '1.9500',
						'2. high': '2.0000',
						'3. low': '1.8900',
						'4. close': '2.0000',
						'5. volume': '21605224'
					},
					'2020-01-31': {
						'1. open': '1.9500',
						'2. high': '1.9600',
						'3. low': '1.8700',
						'4. close': '1.8900',
						'5. volume': '13285704'
					},
					'2020-01-30': {
						'1. open': '1.9100',
						'2. high': '1.9700',
						'3. low': '1.9000',
						'4. close': '1.9400',
						'5. volume': '13764992'
					},
					'2020-01-29': {
						'1. open': '2.0200',
						'2. high': '2.0200',
						'3. low': '1.9200',
						'4. close': '1.9300',
						'5. volume': '17581521'
					},
					'2020-01-28': {
						'1. open': '1.9500',
						'2. high': '2.0000',
						'3. low': '1.9000',
						'4. close': '1.9700',
						'5. volume': '18130830'
					},
					'2020-01-27': {
						'1. open': '1.8800',
						'2. high': '1.9800',
						'3. low': '1.8300',
						'4. close': '1.8900',
						'5. volume': '19975779'
					},
					'2020-01-24': {
						'1. open': '2.1000',
						'2. high': '2.1100',
						'3. low': '1.9700',
						'4. close': '1.9900',
						'5. volume': '22669408'
					},
					'2020-01-23': {
						'1. open': '2.0200',
						'2. high': '2.1200',
						'3. low': '1.9800',
						'4. close': '2.0700',
						'5. volume': '22819356'
					},
					'2020-01-22': {
						'1. open': '2.0300',
						'2. high': '2.1000',
						'3. low': '1.9500',
						'4. close': '2.0400',
						'5. volume': '26286008'
					},
					'2020-01-21': {
						'1. open': '2.1300',
						'2. high': '2.1600',
						'3. low': '1.9400',
						'4. close': '2.0100',
						'5. volume': '38878660'
					},
					'2020-01-17': {
						'1. open': '2.1500',
						'2. high': '2.1900',
						'3. low': '2.0300',
						'4. close': '2.1300',
						'5. volume': '44442586'
					},
					'2020-01-16': {
						'1. open': '2.1900',
						'2. high': '2.3200',
						'3. low': '2.1000',
						'4. close': '2.1500',
						'5. volume': '73663930'
					},
					'2020-01-15': {
						'1. open': '1.8500',
						'2. high': '2.0900',
						'3. low': '1.8100',
						'4. close': '2.0500',
						'5. volume': '76746864'
					},
					'2020-01-14': {
						'1. open': '1.6800',
						'2. high': '1.8500',
						'3. low': '1.6300',
						'4. close': '1.7900',
						'5. volume': '45408566'
					},
					'2020-01-13': {
						'1. open': '1.5700',
						'2. high': '1.7200',
						'3. low': '1.5000',
						'4. close': '1.7000',
						'5. volume': '47148474'
					},
					'2020-01-10': {
						'1. open': '1.7300',
						'2. high': '1.7400',
						'3. low': '1.6500',
						'4. close': '1.6500',
						'5. volume': '36579466'
					},
					'2020-01-09': {
						'1. open': '1.7800',
						'2. high': '1.8800',
						'3. low': '1.7300',
						'4. close': '1.8600',
						'5. volume': '29250937'
					},
					'2020-01-08': {
						'1. open': '1.7800',
						'2. high': '1.8400',
						'3. low': '1.7100',
						'4. close': '1.7400',
						'5. volume': '39843068'
					},
					'2020-01-07': {
						'1. open': '1.9000',
						'2. high': '1.9300',
						'3. low': '1.8300',
						'4. close': '1.8300',
						'5. volume': '25048705'
					},
					'2020-01-06': {
						'1. open': '2.0200',
						'2. high': '2.0300',
						'3. low': '1.8900',
						'4. close': '1.9000',
						'5. volume': '30790087'
					},
					'2020-01-03': {
						'1. open': '2.0200',
						'2. high': '2.1200',
						'3. low': '2.0000',
						'4. close': '2.0000',
						'5. volume': '19146070'
					},
					'2020-01-02': {
						'1. open': '2.2500',
						'2. high': '2.2700',
						'3. low': '2.0200',
						'4. close': '2.0200',
						'5. volume': '31932077'
					},
					'2019-12-31': {
						'1. open': '1.9000',
						'2. high': '2.1800',
						'3. low': '1.8800',
						'4. close': '2.1600',
						'5. volume': '48939342'
					},
					'2019-12-30': {
						'1. open': '1.9000',
						'2. high': '1.9700',
						'3. low': '1.8800',
						'4. close': '1.9100',
						'5. volume': '22081830'
					},
					'2019-12-27': {
						'1. open': '1.9700',
						'2. high': '1.9800',
						'3. low': '1.9100',
						'4. close': '1.9100',
						'5. volume': '27466623'
					},
					'2019-12-26': {
						'1. open': '2.0700',
						'2. high': '2.0800',
						'3. low': '2.0000',
						'4. close': '2.0000',
						'5. volume': '25545341'
					},
					'2019-12-24': {
						'1. open': '2.0200',
						'2. high': '2.0300',
						'3. low': '1.9000',
						'4. close': '1.9900',
						'5. volume': '27637435'
					},
					'2019-12-23': {
						'1. open': '2.1500',
						'2. high': '2.1800',
						'3. low': '2.0100',
						'4. close': '2.0100',
						'5. volume': '40109586'
					},
					'2019-12-20': {
						'1. open': '2.2600',
						'2. high': '2.3000',
						'3. low': '2.2200',
						'4. close': '2.2500',
						'5. volume': '16226796'
					},
					'2019-12-19': {
						'1. open': '2.1900',
						'2. high': '2.3500',
						'3. low': '2.1500',
						'4. close': '2.2700',
						'5. volume': '29919455'
					},
					'2019-12-18': {
						'1. open': '2.3100',
						'2. high': '2.3200',
						'3. low': '2.1800',
						'4. close': '2.1900',
						'5. volume': '38757096'
					},
					'2019-12-17': {
						'1. open': '2.4900',
						'2. high': '2.5000',
						'3. low': '2.3000',
						'4. close': '2.3500',
						'5. volume': '44714581'
					},
					'2019-12-16': {
						'1. open': '2.6500',
						'2. high': '2.6900',
						'3. low': '2.5200',
						'4. close': '2.5400',
						'5. volume': '20007914'
					},
					'2019-12-13': {
						'1. open': '2.6300',
						'2. high': '2.7400',
						'3. low': '2.5900',
						'4. close': '2.6300',
						'5. volume': '24742053'
					},
					'2019-12-12': {
						'1. open': '2.4700',
						'2. high': '2.6100',
						'3. low': '2.4500',
						'4. close': '2.6000',
						'5. volume': '27223505'
					},
					'2019-12-11': {
						'1. open': '2.5200',
						'2. high': '2.6000',
						'3. low': '2.4400',
						'4. close': '2.4500',
						'5. volume': '22732627'
					},
					'2019-12-10': {
						'1. open': '2.5900',
						'2. high': '2.6400',
						'3. low': '2.5000',
						'4. close': '2.5200',
						'5. volume': '17916340'
					},
					'2019-12-09': {
						'1. open': '2.4300',
						'2. high': '2.6300',
						'3. low': '2.4000',
						'4. close': '2.6200',
						'5. volume': '37610208'
					},
					'2019-12-06': {
						'1. open': '2.4300',
						'2. high': '2.4500',
						'3. low': '2.4200',
						'4. close': '2.4300',
						'5. volume': '13752999'
					},
					'2019-12-05': {
						'1. open': '2.4900',
						'2. high': '2.5200',
						'3. low': '2.4200',
						'4. close': '2.4400',
						'5. volume': '19301838'
					},
					'2019-12-04': {
						'1. open': '2.4900',
						'2. high': '2.5000',
						'3. low': '2.4200',
						'4. close': '2.4800',
						'5. volume': '21206927'
					},
					'2019-12-03': {
						'1. open': '2.4000',
						'2. high': '2.5500',
						'3. low': '2.3800',
						'4. close': '2.4700',
						'5. volume': '25566092'
					},
					'2019-12-02': {
						'1. open': '2.5200',
						'2. high': '2.5500',
						'3. low': '2.4100',
						'4. close': '2.4400',
						'5. volume': '17707427'
					},
					'2019-11-29': {
						'1. open': '2.6100',
						'2. high': '2.6200',
						'3. low': '2.4500',
						'4. close': '2.5000',
						'5. volume': '13329532'
					},
					'2019-11-27': {
						'1. open': '2.4700',
						'2. high': '2.5400',
						'3. low': '2.4300',
						'4. close': '2.5200',
						'5. volume': '35981104'
					},
					'2019-11-26': {
						'1. open': '2.4500',
						'2. high': '2.5700',
						'3. low': '2.3600',
						'4. close': '2.3900',
						'5. volume': '40319540'
					},
					'2019-11-25': {
						'1. open': '2.6900',
						'2. high': '2.8200',
						'3. low': '2.5000',
						'4. close': '2.5200',
						'5. volume': '36738441'
					},
					'2019-11-22': {
						'1. open': '3.0800',
						'2. high': '3.1000',
						'3. low': '2.6900',
						'4. close': '2.7000',
						'5. volume': '62956066'
					},
					'2019-11-21': {
						'1. open': '2.7900',
						'2. high': '3.2500',
						'3. low': '2.7000',
						'4. close': '3.1200',
						'5. volume': '107947447'
					},
					'2019-11-20': {
						'1. open': '2.4100',
						'2. high': '2.7300',
						'3. low': '2.3600',
						'4. close': '2.6400',
						'5. volume': '78576425'
					},
					'2019-11-19': {
						'1. open': '2.1800',
						'2. high': '2.4500',
						'3. low': '2.1400',
						'4. close': '2.3400',
						'5. volume': '55864559'
					},
					'2019-11-18': {
						'1. open': '2.7200',
						'2. high': '2.7600',
						'3. low': '2.2600',
						'4. close': '2.2800',
						'5. volume': '65019883'
					},
					'2019-11-15': {
						'1. open': '2.7600',
						'2. high': '3.1700',
						'3. low': '2.7000',
						'4. close': '2.7300',
						'5. volume': '57388615'
					},
					'2019-11-14': {
						'1. open': '3.4200',
						'2. high': '3.4300',
						'3. low': '3.1100',
						'4. close': '3.2900',
						'5. volume': '30475270'
					},
					'2019-11-13': {
						'1. open': '3.5700',
						'2. high': '3.5800',
						'3. low': '3.5000',
						'4. close': '3.5500',
						'5. volume': '14648960'
					},
					'2019-11-12': {
						'1. open': '3.6000',
						'2. high': '3.7000',
						'3. low': '3.5500',
						'4. close': '3.5700',
						'5. volume': '13587056'
					},
					'2019-11-11': {
						'1. open': '3.7500',
						'2. high': '3.7900',
						'3. low': '3.6000',
						'4. close': '3.6200',
						'5. volume': '12916917'
					},
					'2019-11-08': {
						'1. open': '3.6200',
						'2. high': '3.8200',
						'3. low': '3.5600',
						'4. close': '3.8100',
						'5. volume': '19068938'
					},
					'2019-11-07': {
						'1. open': '3.7900',
						'2. high': '3.8200',
						'3. low': '3.5800',
						'4. close': '3.5800',
						'5. volume': '12182664'
					},
					'2019-11-06': {
						'1. open': '3.8000',
						'2. high': '3.9200',
						'3. low': '3.7200',
						'4. close': '3.7300',
						'5. volume': '12846913'
					},
					'2019-11-05': {
						'1. open': '3.6000',
						'2. high': '3.8400',
						'3. low': '3.5900',
						'4. close': '3.7600',
						'5. volume': '13815454'
					},
					'2019-11-04': {
						'1. open': '3.6100',
						'2. high': '3.6655',
						'3. low': '3.5800',
						'4. close': '3.6000',
						'5. volume': '8167810'
					},
					'2019-11-01': {
						'1. open': '3.5800',
						'2. high': '3.6400',
						'3. low': '3.5500',
						'4. close': '3.5800',
						'5. volume': '5885061'
					},
					'2019-10-31': {
						'1. open': '3.6400',
						'2. high': '3.6500',
						'3. low': '3.5100',
						'4. close': '3.5900',
						'5. volume': '8483929'
					},
					'2019-10-30': {
						'1. open': '3.6000',
						'2. high': '3.6900',
						'3. low': '3.5800',
						'4. close': '3.6100',
						'5. volume': '6325918'
					},
					'2019-10-29': {
						'1. open': '3.6700',
						'2. high': '3.6700',
						'3. low': '3.5800',
						'4. close': '3.6000',
						'5. volume': '9705368'
					},
					'2019-10-28': {
						'1. open': '3.8500',
						'2. high': '3.9400',
						'3. low': '3.6800',
						'4. close': '3.6900',
						'5. volume': '13221584'
					},
					'2019-10-25': {
						'1. open': '3.7000',
						'2. high': '3.8300',
						'3. low': '3.6400',
						'4. close': '3.8000',
						'5. volume': '13169618'
					},
					'2019-10-24': {
						'1. open': '3.6800',
						'2. high': '3.7400',
						'3. low': '3.6000',
						'4. close': '3.7200',
						'5. volume': '9306541'
					},
					'2019-10-23': {
						'1. open': '3.5500',
						'2. high': '3.7300',
						'3. low': '3.5000',
						'4. close': '3.6700',
						'5. volume': '13692455'
					},
					'2019-10-22': {
						'1. open': '3.6100',
						'2. high': '3.6600',
						'3. low': '3.5500',
						'4. close': '3.5800',
						'5. volume': '11874765'
					},
					'2019-10-21': {
						'1. open': '3.7000',
						'2. high': '3.7400',
						'3. low': '3.5100',
						'4. close': '3.6900',
						'5. volume': '14682934'
					}
				}
			}
		]
	},
	{
		query: `insert into stock_histories (TIME_SERIES_INTRADAY, stock_id)
            values ($1, (select id from stocks where symbol = 'F'))
            on conflict (stock_id) do
            update set TIME_SERIES_INTRADAY = $1`,
		params: [
			{
				'Meta Data': {
					'1. Information':
						'Intraday (5min) open, high, low, close prices and volume',
					'2. Symbol': 'F',
					'3. Last Refreshed': '2020-03-13 16:00:00',
					'4. Interval': '5min',
					'5. Output Size': 'Compact',
					'6. Time Zone': 'US/Eastern'
				},
				'Time Series (5min)': {
					'2020-03-13 16:00:00': {
						'1. open': '5.5500',
						'2. high': '5.6300',
						'3. low': '5.5500',
						'4. close': '5.6200',
						'5. volume': '4006083'
					},
					'2020-03-13 15:55:00': {
						'1. open': '5.4750',
						'2. high': '5.5600',
						'3. low': '5.4700',
						'4. close': '5.5600',
						'5. volume': '2489813'
					},
					'2020-03-13 15:50:00': {
						'1. open': '5.4200',
						'2. high': '5.4800',
						'3. low': '5.4200',
						'4. close': '5.4800',
						'5. volume': '1799573'
					},
					'2020-03-13 15:45:00': {
						'1. open': '5.3800',
						'2. high': '5.4300',
						'3. low': '5.3800',
						'4. close': '5.4250',
						'5. volume': '1079223'
					},
					'2020-03-13 15:40:00': {
						'1. open': '5.3400',
						'2. high': '5.4200',
						'3. low': '5.3300',
						'4. close': '5.3850',
						'5. volume': '1327881'
					},
					'2020-03-13 15:35:00': {
						'1. open': '5.3950',
						'2. high': '5.4000',
						'3. low': '5.3100',
						'4. close': '5.3350',
						'5. volume': '1469553'
					},
					'2020-03-13 15:30:00': {
						'1. open': '5.3823',
						'2. high': '5.4050',
						'3. low': '5.3800',
						'4. close': '5.3950',
						'5. volume': '1894295'
					},
					'2020-03-13 15:25:00': {
						'1. open': '5.3300',
						'2. high': '5.4000',
						'3. low': '5.3300',
						'4. close': '5.3813',
						'5. volume': '1751957'
					},
					'2020-03-13 15:20:00': {
						'1. open': '5.3450',
						'2. high': '5.3600',
						'3. low': '5.3200',
						'4. close': '5.3300',
						'5. volume': '3416097'
					},
					'2020-03-13 15:15:00': {
						'1. open': '5.3900',
						'2. high': '5.4000',
						'3. low': '5.3400',
						'4. close': '5.3450',
						'5. volume': '2613639'
					},
					'2020-03-13 15:10:00': {
						'1. open': '5.4000',
						'2. high': '5.4000',
						'3. low': '5.3900',
						'4. close': '5.3950',
						'5. volume': '99333'
					},
					'2020-03-13 15:05:00': {
						'1. open': '5.4000',
						'2. high': '5.4300',
						'3. low': '5.3900',
						'4. close': '5.3900',
						'5. volume': '893899'
					},
					'2020-03-13 15:00:00': {
						'1. open': '5.3700',
						'2. high': '5.4000',
						'3. low': '5.3650',
						'4. close': '5.4000',
						'5. volume': '637811'
					},
					'2020-03-13 14:55:00': {
						'1. open': '5.3600',
						'2. high': '5.3750',
						'3. low': '5.3500',
						'4. close': '5.3600',
						'5. volume': '702548'
					},
					'2020-03-13 14:50:00': {
						'1. open': '5.3950',
						'2. high': '5.3950',
						'3. low': '5.3600',
						'4. close': '5.3600',
						'5. volume': '566757'
					},
					'2020-03-13 14:45:00': {
						'1. open': '5.3050',
						'2. high': '5.4050',
						'3. low': '5.3050',
						'4. close': '5.3976',
						'5. volume': '1563669'
					},
					'2020-03-13 14:40:00': {
						'1. open': '5.3550',
						'2. high': '5.3600',
						'3. low': '5.3000',
						'4. close': '5.3100',
						'5. volume': '759633'
					},
					'2020-03-13 14:35:00': {
						'1. open': '5.3700',
						'2. high': '5.3728',
						'3. low': '5.3500',
						'4. close': '5.3550',
						'5. volume': '608027'
					},
					'2020-03-13 14:30:00': {
						'1. open': '5.3800',
						'2. high': '5.3800',
						'3. low': '5.3700',
						'4. close': '5.3725',
						'5. volume': '473396'
					},
					'2020-03-13 14:25:00': {
						'1. open': '5.3750',
						'2. high': '5.3800',
						'3. low': '5.3700',
						'4. close': '5.3800',
						'5. volume': '365114'
					},
					'2020-03-13 14:20:00': {
						'1. open': '5.3650',
						'2. high': '5.3800',
						'3. low': '5.3600',
						'4. close': '5.3750',
						'5. volume': '557046'
					},
					'2020-03-13 14:15:00': {
						'1. open': '5.3700',
						'2. high': '5.3700',
						'3. low': '5.3650',
						'4. close': '5.3700',
						'5. volume': '783628'
					},
					'2020-03-13 14:10:00': {
						'1. open': '5.4000',
						'2. high': '5.4100',
						'3. low': '5.3600',
						'4. close': '5.3629',
						'5. volume': '444544'
					},
					'2020-03-13 14:05:00': {
						'1. open': '5.4400',
						'2. high': '5.4400',
						'3. low': '5.4000',
						'4. close': '5.4100',
						'5. volume': '1075950'
					},
					'2020-03-13 14:00:00': {
						'1. open': '5.4400',
						'2. high': '5.4400',
						'3. low': '5.4124',
						'4. close': '5.4400',
						'5. volume': '798309'
					},
					'2020-03-13 13:55:00': {
						'1. open': '5.4150',
						'2. high': '5.4350',
						'3. low': '5.4135',
						'4. close': '5.4350',
						'5. volume': '815566'
					},
					'2020-03-13 13:50:00': {
						'1. open': '5.3650',
						'2. high': '5.4200',
						'3. low': '5.3622',
						'4. close': '5.4200',
						'5. volume': '796677'
					},
					'2020-03-13 13:45:00': {
						'1. open': '5.3400',
						'2. high': '5.3700',
						'3. low': '5.3350',
						'4. close': '5.3700',
						'5. volume': '596224'
					},
					'2020-03-13 13:40:00': {
						'1. open': '5.3450',
						'2. high': '5.3500',
						'3. low': '5.3200',
						'4. close': '5.3350',
						'5. volume': '832305'
					},
					'2020-03-13 13:35:00': {
						'1. open': '5.3550',
						'2. high': '5.3600',
						'3. low': '5.3400',
						'4. close': '5.3450',
						'5. volume': '1230304'
					},
					'2020-03-13 13:30:00': {
						'1. open': '5.3550',
						'2. high': '5.3600',
						'3. low': '5.3500',
						'4. close': '5.3500',
						'5. volume': '667942'
					},
					'2020-03-13 13:25:00': {
						'1. open': '5.3259',
						'2. high': '5.3600',
						'3. low': '5.3200',
						'4. close': '5.3550',
						'5. volume': '625574'
					},
					'2020-03-13 13:20:00': {
						'1. open': '5.3150',
						'2. high': '5.3300',
						'3. low': '5.3100',
						'4. close': '5.3300',
						'5. volume': '397783'
					},
					'2020-03-13 13:15:00': {
						'1. open': '5.2726',
						'2. high': '5.3100',
						'3. low': '5.2700',
						'4. close': '5.3100',
						'5. volume': '879100'
					},
					'2020-03-13 13:10:00': {
						'1. open': '5.2543',
						'2. high': '5.2700',
						'3. low': '5.2500',
						'4. close': '5.2700',
						'5. volume': '467922'
					},
					'2020-03-13 13:05:00': {
						'1. open': '5.2501',
						'2. high': '5.2800',
						'3. low': '5.2401',
						'4. close': '5.2550',
						'5. volume': '732942'
					},
					'2020-03-13 13:00:00': {
						'1. open': '5.2600',
						'2. high': '5.2600',
						'3. low': '5.2550',
						'4. close': '5.2600',
						'5. volume': '674890'
					},
					'2020-03-13 12:55:00': {
						'1. open': '5.2000',
						'2. high': '5.2600',
						'3. low': '5.2000',
						'4. close': '5.2600',
						'5. volume': '1323703'
					},
					'2020-03-13 12:50:00': {
						'1. open': '5.2350',
						'2. high': '5.2400',
						'3. low': '5.2000',
						'4. close': '5.2050',
						'5. volume': '878206'
					},
					'2020-03-13 12:45:00': {
						'1. open': '5.1950',
						'2. high': '5.2500',
						'3. low': '5.1900',
						'4. close': '5.2350',
						'5. volume': '2783396'
					},
					'2020-03-13 12:40:00': {
						'1. open': '5.2100',
						'2. high': '5.2101',
						'3. low': '5.1901',
						'4. close': '5.1901',
						'5. volume': '996175'
					},
					'2020-03-13 12:35:00': {
						'1. open': '5.2200',
						'2. high': '5.2300',
						'3. low': '5.2100',
						'4. close': '5.2110',
						'5. volume': '2105285'
					},
					'2020-03-13 12:30:00': {
						'1. open': '5.2250',
						'2. high': '5.2300',
						'3. low': '5.2200',
						'4. close': '5.2200',
						'5. volume': '897137'
					},
					'2020-03-13 12:25:00': {
						'1. open': '5.2050',
						'2. high': '5.2300',
						'3. low': '5.2000',
						'4. close': '5.2272',
						'5. volume': '1543858'
					},
					'2020-03-13 12:20:00': {
						'1. open': '5.1950',
						'2. high': '5.2050',
						'3. low': '5.1944',
						'4. close': '5.2050',
						'5. volume': '1353516'
					},
					'2020-03-13 12:15:00': {
						'1. open': '5.1700',
						'2. high': '5.2200',
						'3. low': '5.1700',
						'4. close': '5.1971',
						'5. volume': '1159480'
					},
					'2020-03-13 12:10:00': {
						'1. open': '5.2108',
						'2. high': '5.2139',
						'3. low': '5.1400',
						'4. close': '5.1788',
						'5. volume': '2341219'
					},
					'2020-03-13 12:05:00': {
						'1. open': '5.2750',
						'2. high': '5.2800',
						'3. low': '5.2100',
						'4. close': '5.2100',
						'5. volume': '1605498'
					},
					'2020-03-13 12:00:00': {
						'1. open': '5.2700',
						'2. high': '5.2950',
						'3. low': '5.2700',
						'4. close': '5.2700',
						'5. volume': '1181197'
					},
					'2020-03-13 11:55:00': {
						'1. open': '5.2700',
						'2. high': '5.2710',
						'3. low': '5.2650',
						'4. close': '5.2701',
						'5. volume': '1535677'
					},
					'2020-03-13 11:50:00': {
						'1. open': '5.2950',
						'2. high': '5.3000',
						'3. low': '5.2700',
						'4. close': '5.2750',
						'5. volume': '507400'
					},
					'2020-03-13 11:45:00': {
						'1. open': '5.3650',
						'2. high': '5.3700',
						'3. low': '5.2900',
						'4. close': '5.2931',
						'5. volume': '1560696'
					},
					'2020-03-13 11:40:00': {
						'1. open': '5.3300',
						'2. high': '5.3800',
						'3. low': '5.3300',
						'4. close': '5.3650',
						'5. volume': '1510370'
					},
					'2020-03-13 11:35:00': {
						'1. open': '5.3750',
						'2. high': '5.3800',
						'3. low': '5.3300',
						'4. close': '5.3300',
						'5. volume': '1185619'
					},
					'2020-03-13 11:30:00': {
						'1. open': '5.3950',
						'2. high': '5.4100',
						'3. low': '5.3700',
						'4. close': '5.3700',
						'5. volume': '946716'
					},
					'2020-03-13 11:25:00': {
						'1. open': '5.4050',
						'2. high': '5.4200',
						'3. low': '5.3900',
						'4. close': '5.3957',
						'5. volume': '1055656'
					},
					'2020-03-13 11:20:00': {
						'1. open': '5.3972',
						'2. high': '5.4100',
						'3. low': '5.3800',
						'4. close': '5.4050',
						'5. volume': '1037411'
					},
					'2020-03-13 11:15:00': {
						'1. open': '5.4000',
						'2. high': '5.4000',
						'3. low': '5.3700',
						'4. close': '5.3955',
						'5. volume': '925478'
					},
					'2020-03-13 11:10:00': {
						'1. open': '5.3600',
						'2. high': '5.3950',
						'3. low': '5.3510',
						'4. close': '5.3950',
						'5. volume': '3153828'
					},
					'2020-03-13 11:05:00': {
						'1. open': '5.3500',
						'2. high': '5.3600',
						'3. low': '5.3500',
						'4. close': '5.3550',
						'5. volume': '489739'
					},
					'2020-03-13 11:00:00': {
						'1. open': '5.4600',
						'2. high': '5.4600',
						'3. low': '5.3500',
						'4. close': '5.3500',
						'5. volume': '1175700'
					},
					'2020-03-13 10:55:00': {
						'1. open': '5.4650',
						'2. high': '5.4700',
						'3. low': '5.4500',
						'4. close': '5.4500',
						'5. volume': '655550'
					},
					'2020-03-13 10:50:00': {
						'1. open': '5.4950',
						'2. high': '5.5000',
						'3. low': '5.4600',
						'4. close': '5.4600',
						'5. volume': '564625'
					},
					'2020-03-13 10:45:00': {
						'1. open': '5.4800',
						'2. high': '5.5000',
						'3. low': '5.4700',
						'4. close': '5.4967',
						'5. volume': '1106762'
					},
					'2020-03-13 10:40:00': {
						'1. open': '5.4790',
						'2. high': '5.4900',
						'3. low': '5.4750',
						'4. close': '5.4803',
						'5. volume': '697392'
					},
					'2020-03-13 10:35:00': {
						'1. open': '5.5110',
						'2. high': '5.5150',
						'3. low': '5.4701',
						'4. close': '5.4750',
						'5. volume': '1241682'
					},
					'2020-03-13 10:30:00': {
						'1. open': '5.5450',
						'2. high': '5.5600',
						'3. low': '5.5100',
						'4. close': '5.5159',
						'5. volume': '1014874'
					},
					'2020-03-13 10:25:00': {
						'1. open': '5.5250',
						'2. high': '5.5600',
						'3. low': '5.5200',
						'4. close': '5.5450',
						'5. volume': '922981'
					},
					'2020-03-13 10:20:00': {
						'1. open': '5.5100',
						'2. high': '5.5200',
						'3. low': '5.5001',
						'4. close': '5.5200',
						'5. volume': '1862995'
					},
					'2020-03-13 10:15:00': {
						'1. open': '5.5650',
						'2. high': '5.5699',
						'3. low': '5.5000',
						'4. close': '5.5099',
						'5. volume': '1188722'
					},
					'2020-03-13 10:10:00': {
						'1. open': '5.5385',
						'2. high': '5.5900',
						'3. low': '5.5300',
						'4. close': '5.5650',
						'5. volume': '1564909'
					},
					'2020-03-13 10:05:00': {
						'1. open': '5.4150',
						'2. high': '5.5384',
						'3. low': '5.4070',
						'4. close': '5.5207',
						'5. volume': '1661324'
					},
					'2020-03-13 10:00:00': {
						'1. open': '5.4500',
						'2. high': '5.4500',
						'3. low': '5.4000',
						'4. close': '5.4200',
						'5. volume': '1931749'
					},
					'2020-03-13 09:55:00': {
						'1. open': '5.5741',
						'2. high': '5.5800',
						'3. low': '5.4400',
						'4. close': '5.4401',
						'5. volume': '2348810'
					},
					'2020-03-13 09:50:00': {
						'1. open': '5.7250',
						'2. high': '5.7600',
						'3. low': '5.5700',
						'4. close': '5.5772',
						'5. volume': '3097388'
					},
					'2020-03-13 09:45:00': {
						'1. open': '5.8400',
						'2. high': '5.8500',
						'3. low': '5.7200',
						'4. close': '5.7250',
						'5. volume': '4028258'
					},
					'2020-03-13 09:40:00': {
						'1. open': '5.8500',
						'2. high': '5.8500',
						'3. low': '5.8400',
						'4. close': '5.8450',
						'5. volume': '143834'
					},
					'2020-03-13 09:35:00': {
						'1. open': '5.8700',
						'2. high': '5.9000',
						'3. low': '5.8400',
						'4. close': '5.8500',
						'5. volume': '958065'
					},
					'2020-03-12 16:00:00': {
						'1. open': '5.3600',
						'2. high': '5.3600',
						'3. low': '5.3500',
						'4. close': '5.3600',
						'5. volume': '2229210'
					},
					'2020-03-12 15:55:00': {
						'1. open': '5.3250',
						'2. high': '5.3600',
						'3. low': '5.3250',
						'4. close': '5.3550',
						'5. volume': '2015959'
					},
					'2020-03-12 15:50:00': {
						'1. open': '5.3350',
						'2. high': '5.3355',
						'3. low': '5.3200',
						'4. close': '5.3290',
						'5. volume': '1367816'
					},
					'2020-03-12 15:45:00': {
						'1. open': '5.3350',
						'2. high': '5.3450',
						'3. low': '5.3300',
						'4. close': '5.3350',
						'5. volume': '1401976'
					},
					'2020-03-12 15:40:00': {
						'1. open': '5.3300',
						'2. high': '5.3400',
						'3. low': '5.3300',
						'4. close': '5.3332',
						'5. volume': '581961'
					},
					'2020-03-12 15:35:00': {
						'1. open': '5.3354',
						'2. high': '5.3400',
						'3. low': '5.3350',
						'4. close': '5.3350',
						'5. volume': '668500'
					},
					'2020-03-12 15:30:00': {
						'1. open': '5.3400',
						'2. high': '5.3450',
						'3. low': '5.3350',
						'4. close': '5.3350',
						'5. volume': '574480'
					},
					'2020-03-12 15:25:00': {
						'1. open': '5.3550',
						'2. high': '5.3565',
						'3. low': '5.3400',
						'4. close': '5.3400',
						'5. volume': '526656'
					},
					'2020-03-12 15:20:00': {
						'1. open': '5.3500',
						'2. high': '5.3600',
						'3. low': '5.3500',
						'4. close': '5.3550',
						'5. volume': '381525'
					},
					'2020-03-12 15:15:00': {
						'1. open': '5.3500',
						'2. high': '5.3600',
						'3. low': '5.3500',
						'4. close': '5.3550',
						'5. volume': '373170'
					},
					'2020-03-12 15:10:00': {
						'1. open': '5.3550',
						'2. high': '5.3700',
						'3. low': '5.3300',
						'4. close': '5.3500',
						'5. volume': '856262'
					},
					'2020-03-12 15:05:00': {
						'1. open': '5.3450',
						'2. high': '5.3600',
						'3. low': '5.3400',
						'4. close': '5.3550',
						'5. volume': '530938'
					},
					'2020-03-12 15:00:00': {
						'1. open': '5.3500',
						'2. high': '5.3500',
						'3. low': '5.3350',
						'4. close': '5.3500',
						'5. volume': '600963'
					},
					'2020-03-12 14:55:00': {
						'1. open': '5.3567',
						'2. high': '5.3750',
						'3. low': '5.3400',
						'4. close': '5.3400',
						'5. volume': '625607'
					},
					'2020-03-12 14:50:00': {
						'1. open': '5.3050',
						'2. high': '5.3600',
						'3. low': '5.3000',
						'4. close': '5.3550',
						'5. volume': '906704'
					},
					'2020-03-12 14:45:00': {
						'1. open': '5.3150',
						'2. high': '5.3300',
						'3. low': '5.3000',
						'4. close': '5.3050',
						'5. volume': '792770'
					},
					'2020-03-12 14:40:00': {
						'1. open': '5.3300',
						'2. high': '5.3381',
						'3. low': '5.3100',
						'4. close': '5.3127',
						'5. volume': '506254'
					},
					'2020-03-12 14:35:00': {
						'1. open': '5.3450',
						'2. high': '5.3453',
						'3. low': '5.3350',
						'4. close': '5.3350',
						'5. volume': '569823'
					},
					'2020-03-12 14:30:00': {
						'1. open': '5.3400',
						'2. high': '5.3600',
						'3. low': '5.3400',
						'4. close': '5.3450',
						'5. volume': '653437'
					},
					'2020-03-12 14:25:00': {
						'1. open': '5.3700',
						'2. high': '5.3800',
						'3. low': '5.3400',
						'4. close': '5.3493',
						'5. volume': '621802'
					},
					'2020-03-12 14:20:00': {
						'1. open': '5.3850',
						'2. high': '5.3900',
						'3. low': '5.3750',
						'4. close': '5.3750',
						'5. volume': '440356'
					},
					'2020-03-12 14:15:00': {
						'1. open': '5.4050',
						'2. high': '5.4200',
						'3. low': '5.3800',
						'4. close': '5.3800',
						'5. volume': '581195'
					}
				}
			}
		]
	},
	{
		query: `insert into stock_histories (TIME_SERIES_DAILY, stock_id)
            values ($1, (select id from stocks where symbol = 'F'))
            on conflict (stock_id) do
            update set TIME_SERIES_DAILY = $1`,

		params: [
			{
				'Meta Data': {
					'1. Information': 'Daily Prices (open, high, low, close) and Volumes',
					'2. Symbol': 'F',
					'3. Last Refreshed': '2020-03-13',
					'4. Output Size': 'Compact',
					'5. Time Zone': 'US/Eastern'
				},
				'Time Series (Daily)': {
					'2020-03-13': {
						'1. open': '5.8700',
						'2. high': '5.9000',
						'3. low': '5.1200',
						'4. close': '5.6300',
						'5. volume': '125290368'
					},
					'2020-03-12': {
						'1. open': '5.3800',
						'2. high': '5.6900',
						'3. low': '5.2000',
						'4. close': '5.3500',
						'5. volume': '89299008'
					},
					'2020-03-11': {
						'1. open': '6.0600',
						'2. high': '6.1100',
						'3. low': '5.8800',
						'4. close': '5.9000',
						'5. volume': '97775848'
					},
					'2020-03-10': {
						'1. open': '6.2600',
						'2. high': '6.2900',
						'3. low': '5.8000',
						'4. close': '6.2600',
						'5. volume': '101774354'
					},
					'2020-03-09': {
						'1. open': '5.9700',
						'2. high': '6.1400',
						'3. low': '5.8700',
						'4. close': '5.9000',
						'5. volume': '103747117'
					},
					'2020-03-06': {
						'1. open': '6.6000',
						'2. high': '6.6800',
						'3. low': '6.4000',
						'4. close': '6.4900',
						'5. volume': '109864377'
					},
					'2020-03-05': {
						'1. open': '6.9600',
						'2. high': '6.9700',
						'3. low': '6.7100',
						'4. close': '6.7400',
						'5. volume': '78016662'
					},
					'2020-03-04': {
						'1. open': '7.0900',
						'2. high': '7.0900',
						'3. low': '6.9200',
						'4. close': '7.0800',
						'5. volume': '70559822'
					},
					'2020-03-03': {
						'1. open': '7.2900',
						'2. high': '7.3400',
						'3. low': '6.8900',
						'4. close': '6.9700',
						'5. volume': '97397798'
					},
					'2020-03-02': {
						'1. open': '7.1100',
						'2. high': '7.2300',
						'3. low': '6.8800',
						'4. close': '7.2000',
						'5. volume': '96728883'
					},
					'2020-02-28': {
						'1. open': '6.8400',
						'2. high': '6.9600',
						'3. low': '6.6700',
						'4. close': '6.9600',
						'5. volume': '116484975'
					},
					'2020-02-27': {
						'1. open': '7.1300',
						'2. high': '7.2800',
						'3. low': '6.9200',
						'4. close': '6.9700',
						'5. volume': '118585243'
					},
					'2020-02-26': {
						'1. open': '7.3000',
						'2. high': '7.4600',
						'3. low': '7.2100',
						'4. close': '7.2100',
						'5. volume': '92461064'
					},
					'2020-02-25': {
						'1. open': '7.6800',
						'2. high': '7.6800',
						'3. low': '7.2200',
						'4. close': '7.2300',
						'5. volume': '108818217'
					},
					'2020-02-24': {
						'1. open': '7.7000',
						'2. high': '7.7197',
						'3. low': '7.5500',
						'4. close': '7.5700',
						'5. volume': '109885240'
					},
					'2020-02-21': {
						'1. open': '8.0200',
						'2. high': '8.0300',
						'3. low': '7.8900',
						'4. close': '7.8900',
						'5. volume': '58296111'
					},
					'2020-02-20': {
						'1. open': '8.0000',
						'2. high': '8.0700',
						'3. low': '7.9900',
						'4. close': '8.0300',
						'5. volume': '52299986'
					},
					'2020-02-19': {
						'1. open': '8.0600',
						'2. high': '8.1000',
						'3. low': '8.0000',
						'4. close': '8.0000',
						'5. volume': '64234326'
					},
					'2020-02-18': {
						'1. open': '8.1200',
						'2. high': '8.1499',
						'3. low': '8.0200',
						'4. close': '8.0600',
						'5. volume': '65063386'
					},
					'2020-02-14': {
						'1. open': '8.2700',
						'2. high': '8.2700',
						'3. low': '8.0800',
						'4. close': '8.1000',
						'5. volume': '46328367'
					},
					'2020-02-13': {
						'1. open': '8.2100',
						'2. high': '8.3600',
						'3. low': '8.2100',
						'4. close': '8.2500',
						'5. volume': '67629392'
					},
					'2020-02-12': {
						'1. open': '8.1400',
						'2. high': '8.3300',
						'3. low': '8.1300',
						'4. close': '8.2400',
						'5. volume': '111488172'
					},
					'2020-02-11': {
						'1. open': '8.1000',
						'2. high': '8.1500',
						'3. low': '8.0800',
						'4. close': '8.1000',
						'5. volume': '80119254'
					},
					'2020-02-10': {
						'1. open': '8.1500',
						'2. high': '8.1500',
						'3. low': '8.0500',
						'4. close': '8.0600',
						'5. volume': '71766535'
					},
					'2020-02-07': {
						'1. open': '8.2100',
						'2. high': '8.2100',
						'3. low': '8.0200',
						'4. close': '8.1100',
						'5. volume': '98215504'
					},
					'2020-02-06': {
						'1. open': '8.3700',
						'2. high': '8.3800',
						'3. low': '8.2500',
						'4. close': '8.2500',
						'5. volume': '68796857'
					},
					'2020-02-05': {
						'1. open': '8.4100',
						'2. high': '8.4800',
						'3. low': '8.2600',
						'4. close': '8.3100',
						'5. volume': '145609270'
					},
					'2020-02-04': {
						'1. open': '9.0800',
						'2. high': '9.2400',
						'3. low': '9.0700',
						'4. close': '9.1800',
						'5. volume': '85687868'
					},
					'2020-02-03': {
						'1. open': '8.8500',
						'2. high': '9.1400',
						'3. low': '8.8500',
						'4. close': '8.9800',
						'5. volume': '71394902'
					},
					'2020-01-31': {
						'1. open': '8.7800',
						'2. high': '8.8400',
						'3. low': '8.7400',
						'4. close': '8.8200',
						'5. volume': '59781010'
					},
					'2020-01-30': {
						'1. open': '8.8100',
						'2. high': '8.8400',
						'3. low': '8.7300',
						'4. close': '8.8400',
						'5. volume': '42810593'
					},
					'2020-01-29': {
						'1. open': '8.8500',
						'2. high': '8.9550',
						'3. low': '8.8400',
						'4. close': '8.8600',
						'5. volume': '59055831'
					},
					'2020-01-28': {
						'1. open': '8.9400',
						'2. high': '9.0000',
						'3. low': '8.8600',
						'4. close': '8.9700',
						'5. volume': '85106498'
					},
					'2020-01-27': {
						'1. open': '8.8800',
						'2. high': '8.9600',
						'3. low': '8.7800',
						'4. close': '8.8900',
						'5. volume': '60752070'
					},
					'2020-01-24': {
						'1. open': '9.1100',
						'2. high': '9.1200',
						'3. low': '8.9600',
						'4. close': '9.0000',
						'5. volume': '68069640'
					},
					'2020-01-23': {
						'1. open': '9.1400',
						'2. high': '9.1600',
						'3. low': '8.9300',
						'4. close': '9.1400',
						'5. volume': '75830388'
					},
					'2020-01-22': {
						'1. open': '9.2200',
						'2. high': '9.2500',
						'3. low': '9.1500',
						'4. close': '9.1600',
						'5. volume': '39901121'
					},
					'2020-01-21': {
						'1. open': '9.1500',
						'2. high': '9.2200',
						'3. low': '9.1000',
						'4. close': '9.2100',
						'5. volume': '49482591'
					},
					'2020-01-17': {
						'1. open': '9.1900',
						'2. high': '9.2300',
						'3. low': '9.1300',
						'4. close': '9.1600',
						'5. volume': '41642886'
					},
					'2020-01-16': {
						'1. open': '9.2300',
						'2. high': '9.2800',
						'3. low': '9.1500',
						'4. close': '9.1700',
						'5. volume': '44276531'
					},
					'2020-01-15': {
						'1. open': '9.2700',
						'2. high': '9.3000',
						'3. low': '9.1800',
						'4. close': '9.1900',
						'5. volume': '55908909'
					},
					'2020-01-14': {
						'1. open': '9.2200',
						'2. high': '9.3300',
						'3. low': '9.2100',
						'4. close': '9.2900',
						'5. volume': '42935596'
					},
					'2020-01-13': {
						'1. open': '9.2500',
						'2. high': '9.2600',
						'3. low': '9.1100',
						'4. close': '9.2400',
						'5. volume': '48552343'
					},
					'2020-01-10': {
						'1. open': '9.2700',
						'2. high': '9.3600',
						'3. low': '9.2500',
						'4. close': '9.2500',
						'5. volume': '39796154'
					},
					'2020-01-09': {
						'1. open': '9.3000',
						'2. high': '9.3100',
						'3. low': '9.1800',
						'4. close': '9.2600',
						'5. volume': '51817296'
					},
					'2020-01-08': {
						'1. open': '9.2300',
						'2. high': '9.3000',
						'3. low': '9.1700',
						'4. close': '9.2500',
						'5. volume': '45994922'
					},
					'2020-01-07': {
						'1. open': '9.2000',
						'2. high': '9.2500',
						'3. low': '9.1200',
						'4. close': '9.2500',
						'5. volume': '45076037'
					},
					'2020-01-06': {
						'1. open': '9.1000',
						'2. high': '9.1700',
						'3. low': '9.0600',
						'4. close': '9.1600',
						'5. volume': '43310580'
					},
					'2020-01-03': {
						'1. open': '9.3100',
						'2. high': '9.3700',
						'3. low': '9.1500',
						'4. close': '9.2100',
						'5. volume': '45040324'
					},
					'2020-01-02': {
						'1. open': '9.2900',
						'2. high': '9.4200',
						'3. low': '9.1900',
						'4. close': '9.4200',
						'5. volume': '43423425'
					},
					'2019-12-31': {
						'1. open': '9.2500',
						'2. high': '9.3300',
						'3. low': '9.2400',
						'4. close': '9.3000',
						'5. volume': '32342009'
					},
					'2019-12-30': {
						'1. open': '9.3400',
						'2. high': '9.3500',
						'3. low': '9.2300',
						'4. close': '9.2500',
						'5. volume': '36074759'
					},
					'2019-12-27': {
						'1. open': '9.4500',
						'2. high': '9.4600',
						'3. low': '9.3450',
						'4. close': '9.3600',
						'5. volume': '28272815'
					},
					'2019-12-26': {
						'1. open': '9.4700',
						'2. high': '9.4900',
						'3. low': '9.4300',
						'4. close': '9.4500',
						'5. volume': '28960242'
					},
					'2019-12-24': {
						'1. open': '9.4400',
						'2. high': '9.4900',
						'3. low': '9.4300',
						'4. close': '9.4700',
						'5. volume': '11881604'
					},
					'2019-12-23': {
						'1. open': '9.5000',
						'2. high': '9.5700',
						'3. low': '9.4000',
						'4. close': '9.4400',
						'5. volume': '54784445'
					},
					'2019-12-20': {
						'1. open': '9.5000',
						'2. high': '9.5400',
						'3. low': '9.4400',
						'4. close': '9.4800',
						'5. volume': '50157556'
					},
					'2019-12-19': {
						'1. open': '9.5500',
						'2. high': '9.5700',
						'3. low': '9.3800',
						'4. close': '9.4100',
						'5. volume': '42236038'
					},
					'2019-12-18': {
						'1. open': '9.3900',
						'2. high': '9.5750',
						'3. low': '9.3600',
						'4. close': '9.5400',
						'5. volume': '45905209'
					},
					'2019-12-17': {
						'1. open': '9.3800',
						'2. high': '9.4100',
						'3. low': '9.3100',
						'4. close': '9.3900',
						'5. volume': '35503941'
					},
					'2019-12-16': {
						'1. open': '9.2400',
						'2. high': '9.3900',
						'3. low': '9.2200',
						'4. close': '9.3900',
						'5. volume': '42336297'
					},
					'2019-12-13': {
						'1. open': '9.3200',
						'2. high': '9.3900',
						'3. low': '9.1900',
						'4. close': '9.2300',
						'5. volume': '35334277'
					},
					'2019-12-12': {
						'1. open': '9.1100',
						'2. high': '9.3600',
						'3. low': '9.1050',
						'4. close': '9.3200',
						'5. volume': '48389732'
					},
					'2019-12-11': {
						'1. open': '9.0600',
						'2. high': '9.1400',
						'3. low': '9.0550',
						'4. close': '9.1100',
						'5. volume': '32532321'
					},
					'2019-12-10': {
						'1. open': '9.0200',
						'2. high': '9.1000',
						'3. low': '8.9600',
						'4. close': '9.0700',
						'5. volume': '34214386'
					},
					'2019-12-09': {
						'1. open': '8.9700',
						'2. high': '9.0700',
						'3. low': '8.9600',
						'4. close': '9.0100',
						'5. volume': '21772922'
					},
					'2019-12-06': {
						'1. open': '8.9600',
						'2. high': '9.0700',
						'3. low': '8.9450',
						'4. close': '9.0200',
						'5. volume': '31084884'
					},
					'2019-12-05': {
						'1. open': '8.9700',
						'2. high': '9.0000',
						'3. low': '8.8800',
						'4. close': '8.9300',
						'5. volume': '25766900'
					},
					'2019-12-04': {
						'1. open': '8.9500',
						'2. high': '9.0300',
						'3. low': '8.9400',
						'4. close': '8.9500',
						'5. volume': '29982853'
					},
					'2019-12-03': {
						'1. open': '8.9500',
						'2. high': '8.9500',
						'3. low': '8.8000',
						'4. close': '8.8900',
						'5. volume': '41107429'
					},
					'2019-12-02': {
						'1. open': '9.0800',
						'2. high': '9.1400',
						'3. low': '9.0000',
						'4. close': '9.0100',
						'5. volume': '37232621'
					},
					'2019-11-29': {
						'1. open': '9.0400',
						'2. high': '9.1000',
						'3. low': '9.0300',
						'4. close': '9.0600',
						'5. volume': '13096150'
					},
					'2019-11-27': {
						'1. open': '9.0300',
						'2. high': '9.1500',
						'3. low': '9.0200',
						'4. close': '9.1000',
						'5. volume': '37395958'
					},
					'2019-11-26': {
						'1. open': '8.9800',
						'2. high': '9.0200',
						'3. low': '8.9100',
						'4. close': '9.0100',
						'5. volume': '30262639'
					},
					'2019-11-25': {
						'1. open': '8.9000',
						'2. high': '9.0100',
						'3. low': '8.8700',
						'4. close': '9.0000',
						'5. volume': '30580848'
					},
					'2019-11-22': {
						'1. open': '8.8100',
						'2. high': '8.9000',
						'3. low': '8.7700',
						'4. close': '8.8900',
						'5. volume': '34957711'
					},
					'2019-11-21': {
						'1. open': '8.7700',
						'2. high': '8.7900',
						'3. low': '8.6700',
						'4. close': '8.7100',
						'5. volume': '33144363'
					},
					'2019-11-20': {
						'1. open': '8.8800',
						'2. high': '8.8900',
						'3. low': '8.6800',
						'4. close': '8.7300',
						'5. volume': '38263281'
					},
					'2019-11-19': {
						'1. open': '8.9900',
						'2. high': '9.0000',
						'3. low': '8.8700',
						'4. close': '8.9000',
						'5. volume': '31168612'
					},
					'2019-11-18': {
						'1. open': '9.0500',
						'2. high': '9.0500',
						'3. low': '8.8900',
						'4. close': '8.9500',
						'5. volume': '38291348'
					},
					'2019-11-15': {
						'1. open': '8.8500',
						'2. high': '8.9600',
						'3. low': '8.8500',
						'4. close': '8.9500',
						'5. volume': '26416272'
					},
					'2019-11-14': {
						'1. open': '8.8500',
						'2. high': '8.9059',
						'3. low': '8.7800',
						'4. close': '8.7900',
						'5. volume': '26527804'
					},
					'2019-11-13': {
						'1. open': '9.0000',
						'2. high': '9.0000',
						'3. low': '8.8000',
						'4. close': '8.8100',
						'5. volume': '34810721'
					},
					'2019-11-12': {
						'1. open': '9.0600',
						'2. high': '9.1300',
						'3. low': '9.0400',
						'4. close': '9.0400',
						'5. volume': '28703857'
					},
					'2019-11-11': {
						'1. open': '8.9500',
						'2. high': '9.1000',
						'3. low': '8.9400',
						'4. close': '9.0800',
						'5. volume': '24840661'
					},
					'2019-11-08': {
						'1. open': '8.9000',
						'2. high': '9.0400',
						'3. low': '8.8200',
						'4. close': '9.0400',
						'5. volume': '29476510'
					},
					'2019-11-07': {
						'1. open': '8.9600',
						'2. high': '9.0100',
						'3. low': '8.8800',
						'4. close': '8.8900',
						'5. volume': '32631018'
					},
					'2019-11-06': {
						'1. open': '9.0500',
						'2. high': '9.0500',
						'3. low': '8.8900',
						'4. close': '8.9200',
						'5. volume': '39495796'
					},
					'2019-11-05': {
						'1. open': '9.0200',
						'2. high': '9.1500',
						'3. low': '9.0000',
						'4. close': '9.0200',
						'5. volume': '37547340'
					},
					'2019-11-04': {
						'1. open': '8.9300',
						'2. high': '9.0500',
						'3. low': '8.9300',
						'4. close': '9.0000',
						'5. volume': '46708442'
					},
					'2019-11-01': {
						'1. open': '8.6400',
						'2. high': '8.9300',
						'3. low': '8.6400',
						'4. close': '8.8900',
						'5. volume': '55324129'
					},
					'2019-10-31': {
						'1. open': '8.5800',
						'2. high': '8.6000',
						'3. low': '8.5000',
						'4. close': '8.5900',
						'5. volume': '29108371'
					},
					'2019-10-30': {
						'1. open': '8.6400',
						'2. high': '8.6400',
						'3. low': '8.5200',
						'4. close': '8.5400',
						'5. volume': '28675948'
					},
					'2019-10-29': {
						'1. open': '8.5900',
						'2. high': '8.7100',
						'3. low': '8.5900',
						'4. close': '8.6400',
						'5. volume': '36745871'
					},
					'2019-10-28': {
						'1. open': '8.7600',
						'2. high': '8.7600',
						'3. low': '8.5800',
						'4. close': '8.6100',
						'5. volume': '39603892'
					},
					'2019-10-25': {
						'1. open': '8.6700',
						'2. high': '8.7500',
						'3. low': '8.6200',
						'4. close': '8.7200',
						'5. volume': '51199431'
					},
					'2019-10-24': {
						'1. open': '8.8700',
						'2. high': '8.8900',
						'3. low': '8.5500',
						'4. close': '8.6000',
						'5. volume': '121071017'
					},
					'2019-10-23': {
						'1. open': '9.0100',
						'2. high': '9.2100',
						'3. low': '8.9700',
						'4. close': '9.2100',
						'5. volume': '46465855'
					},
					'2019-10-22': {
						'1. open': '9.0100',
						'2. high': '9.1400',
						'3. low': '8.9600',
						'4. close': '9.0700',
						'5. volume': '35992321'
					},
					'2019-10-21': {
						'1. open': '9.1900',
						'2. high': '9.2450',
						'3. low': '9.0100',
						'4. close': '9.0300',
						'5. volume': '33801573'
					}
				}
			}
		]
	}
];

const testStockData = [
	{ name: 'Aurora Cannabis', symbol: 'ACB' },

	{ name: 'Ford', symbol: 'F' },

	{ name: 'GE', symbol: 'GE' },

	{ name: 'Microsoft', symbol: 'MSFT' },

	{ name: 'GoPro', symbol: 'GPRO' }
];

const extraStockDataForProduction = [
	{ name: 'Disney', symbol: 'DIS' },

	{ name: 'Apple', symbol: 'AAPL' },

	{ name: 'Fitbit', symbol: 'FIT' },

	{ name: 'Plug Power', symbol: 'PLUG' },

	{ name: 'Snap', symbol: 'SNAP' },

	{ name: 'AMD', symbol: 'AMD' },

	{ name: 'Cronos Group', symbol: 'CRON' },

	{ name: 'Inovio', symbol: 'INO' },

	{ name: 'Canopy Growth', symbol: 'CGC' },

	{ name: 'Chesapeake Energy', symbol: 'CHK' },

	{ name: 'Tesla', symbol: 'TSLA' },

	{ name: 'Bank of America', symbol: 'BAC' },

	{ name: 'Facebook', symbol: 'FB' },

	{ name: 'Uber', symbol: 'UBER' },

	{ name: 'Twitter', symbol: 'TWTR' },

	{ name: 'Zynga', symbol: 'ZNGA' },

	{ name: 'Alibaba', symbol: 'BABA' },

	{ name: 'NIO', symbol: 'NIO' },

	{ name: 'Starbucks', symbol: 'SBUX' },

	{ name: 'Groupon', symbol: 'GRPN' },

	{ name: 'Amazon', symbol: 'AMZN' },

	{ name: 'AT&T', symbol: 'T' },

	{ name: 'Aphria', symbol: 'APHA' },

	{ name: 'Sprint', symbol: 'S' },

	{ name: 'Netflix', symbol: 'NFLX' },

	{ name: 'NVIDIA', symbol: 'NVDA' },

	{ name: 'Virgin Galactic Holdings', symbol: 'SPCE' },

	{ name: 'Coca-Cola', symbol: 'KO' },

	{ name: 'Vanguard S&P 500 ETF', symbol: 'VOO' },

	{ name: 'Vivint Solar', symbol: 'VSLR' },

	{ name: 'American Airlines', symbol: 'AAL' },

	{ name: 'Nokia', symbol: 'NOK' },

	{ name: 'Square', symbol: 'SQ' },

	{ name: 'Slack', symbol: 'WORK' },

	{ name: 'Beyond Meat', symbol: 'BYND' },

	{ name: 'Catalyst Pharmaceuticals', symbol: 'CPRX' },

	{ name: 'Lyft', symbol: 'LYFT' },

	{ name: 'SPDR S&P 500 ETF', symbol: 'SPY' },

	{ name: 'Sirius XM', symbol: 'SIRI' },

	{ name: 'Nike', symbol: 'NKE' },

	{ name: 'Boeing', symbol: 'BA' },

	{ name: 'Visa', symbol: 'V' },

	{ name: 'Delta Air Lines', symbol: 'DAL' },

	{ name: 'Moderna', symbol: 'MRNA' },

	{ name: 'FuelCell Energy', symbol: 'FCEL' },

	{ name: 'Nintendo', symbol: 'NTDOY' },

	{ name: 'Corbus Pharmaceuticals', symbol: 'CRBP' },

	{ name: 'Carnival', symbol: 'CCL' },

	{ name: 'OrganiGram', symbol: 'OGI' },

	{ name: 'GM', symbol: 'GM' },

	{ name: 'Intel', symbol: 'INTC' },

	{ name: 'Activision Blizzard', symbol: 'ATVI' },

	{ name: 'Tilray', symbol: 'TLRY' },

	{ name: 'Exxon Mobil', symbol: 'XOM' },

	{ name: 'New Residential Investment', symbol: 'NRZ' },

	{ name: 'Glu Mobile', symbol: 'GLUU' },

	{ name: 'Cisco', symbol: 'CSCO' },

	{ name: 'Berkshire Hathaway', symbol: 'BRK.B' },

	{ name: 'Yamana Gold', symbol: 'AUY' },

	{ name: 'OPKO Health', symbol: 'OPK' },

	{ name: 'Micron Technology', symbol: 'MU' },

	{ name: 'Luckin Coffee', symbol: 'LK' },

	{ name: 'Viking Therapeutics', symbol: 'VKTX' },

	{ name: 'Vanguard Total Stock Market ETF', symbol: 'VTI' },

	{ name: 'Penn National Gaming', symbol: 'PENN' },

	{ name: 'Tencent', symbol: 'TCEHY' },

	{ name: 'Roku', symbol: 'ROKU' },

	{ name: 'Pfizer', symbol: 'PFE' },

	{ name: 'PayPal', symbol: 'PYPL' },

	{ name: 'ETFMG Alternative Harvest', symbol: 'MJ' },

	{ name: 'Salesforce', symbol: 'CRM' },

	{ name: 'Alphabet Class A', symbol: 'GOOGL' },

	{ name: 'Sony', symbol: 'SNE' },

	{ name: 'Walmart', symbol: 'WMT' },

	{ name: 'PG&E', symbol: 'PCG' },

	{ name: 'Zoom', symbol: 'ZM' },

	{ name: 'Verizon', symbol: 'VZ' },

	{ name: 'Novavax', symbol: 'NVAX' },

	{ name: 'Pinterest', symbol: 'PINS' },

	{ name: 'Gilead Sciences', symbol: 'GILD' },

	{
		name: 'PowerShares S&P 500 High Dividend Low Volatility ETF',
		symbol: 'SPHD'
	},

	{ name: 'Enphase Energy', symbol: 'ENPH' },

	{ name: 'Shopify', symbol: 'SHOP' },

	{ name: 'Peloton Interactive', symbol: 'PTON' },

	{ name: 'Costco', symbol: 'COST' },

	{ name: 'iQIYI', symbol: 'IQ' },

	{ name: 'Bilibili', symbol: 'BILI' },

	{ name: 'JPMorgan Chase', symbol: 'JPM' },

	{ name: 'Dropbox', symbol: 'DBX' },

	{ name: 'CRISPR', symbol: 'CRSP' },

	{ name: 'SmileDirectClub', symbol: 'SDC' },

	{ name: 'Twilio', symbol: 'TWLO' },

	{ name: 'JD.com', symbol: 'JD' },

	{ name: 'Energy Transfer', symbol: 'ET' },

	{ name: 'AbbVie', symbol: 'ABBV' }
];

//returns the query string and params for a single stocks intraday, daily, and weekly data
const buildStockQueries = (stock: IStock) => {
	const queries: IQuery[] = [];

	const apiFunctions = [
		'TIME_SERIES_INTRADAY',
		'TIME_SERIES_DAILY',
		'TIME_SERIES_WEEKLY'
	];

	const stockSymbol = stock.symbol;
	const urlIntraday = `https://www.alphavantage.co/query?function=${apiFunctions[0]}&symbol=${stockSymbol}&interval=5min&apikey=${process.env.ALPHA_VANTAGE_KEY}`;
	const urlDaily = `https://www.alphavantage.co/query?function=${apiFunctions[1]}&symbol=${stockSymbol}&interval=5min&apikey=${process.env.ALPHA_VANTAGE_KEY}`;
	const urlWeekly = `https://www.alphavantage.co/query?function=${apiFunctions[2]}&symbol=${stockSymbol}&interval=5min&apikey=${process.env.ALPHA_VANTAGE_KEY}`;

	return Promise.all([
		axios.get(urlIntraday),
		axios.get(urlDaily),
		axios.get(urlWeekly)
	]).then(resultsArray => {
		//Push each result into queries in form {query, params}. Note APIfunction name is same as DB col name
		apiFunctions.forEach((apiFunction, i) => {
			queries.push({
				query: `
            insert into stock_histories (${apiFunction}, stock_id)
            values ($1, (select id from stocks where symbol = '${stockSymbol}'))
            on conflict (stock_id) do
            update set ${apiFunction} = $1`,
				params: [resultsArray[i].data]
			});
		});
		return queries;
	});
};

const runStockQueries = (stocks: IStock[]) => {
	//allQueries of form [ {query, params}, {query,params}, ...]
	let allQueries: IQuery[] = [];
	let i = 0;

	//Interval used to avoid API call limits
	const buildQueryInterval = setInterval(async () => {
		//buildStockQueries returns [ {query1, params1}, {query2, params2}, {query3, params3} ]
		const queries = await buildStockQueries(stocks[i]);
		console.log(`API call ${i} completed`);
		allQueries = [...allQueries, ...queries];
		i++;
		if (i === stocks.length) {
			clearInterval(buildQueryInterval);
			runQueries(allQueries);
		}
	}, 65000);
};

//allQueries of form [ {query, params}, {query,params}, ...]
const runQueries = async (allQueries: IQuery[]) => {
	for (const queryInfo of allQueries) {
		await db.query(queryInfo.query, queryInfo.params);
	}
	console.log('done');
	process.exit();
};

runStockQueries(testStockData);
